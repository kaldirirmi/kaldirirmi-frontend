<dom-module id="home-news">
    <template>
        <style include="shared-styles">
            figure {
                margin: 10px;
                box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.4);
            }

            figcaption {
                margin-left: 10px;
                margin-bottom: 10px;
                color: #fff;
                padding-right: 20px;
            }

            iron-image {
                max-width: 100%;
                width: 100%;
                /* height: 12.5em; */
            }

            /***************** NEWS CONTAINER ***************************/

            #news-container {
                @apply --layout-horizontal;
                margin: 10px 0px;
                @apply --shadow-elevation-2dp;
                margin-top: 0px;
            }

                #news-container .main-catalog {
                    @apply --layout-flex-9;
                    @apply --layout-vertical;
                }

            .main-catalog .advert-catalog {
                @apply --layout-flex-3;
                background: var(--app-theme-color);
                opacity: 0.3;
                padding: 10px;
            }

            .main-catalog .news-catalog {
                @apply --layout-flex-8;
                @apply --layout-horizontal;
                padding: 10px;
            }

                .main-catalog .news-catalog .big-news-catalog {
                    @apply --layout-flex-8;
                    @apply --layout-vertical;
                }

                .main-catalog .news-catalog .small-news-catalog {
                    @apply --layout-vertical;
                    @apply --layout-flex-4;
                    padding: 0px 10px;
                }

            #news-container .side-catalog {
                @apply --layout-flex-4;
                padding: 10px;
            }

            .side-catalog #items {
                @apply --layout-vertical;
            }

            .continue-item {
                @apply --layout-vertical;
                padding-top: 5px;
                background-color: var(--app-theme-color);
                color: #fff;
                text-decoration: none;
            }

            /* Smartphones (portrait and landscape) ----------- */

            /* @media only screen and (min-device-width: 320px) and (max-device-width: 480px) {
                #news-container, #news-container .news-catalog{
                    @apply --layout-vertical;
                    margin-left: -5px;
                }
                #news-container,
                #news-container .news-catalog .small-news-catalog {
                    padding: 0px;
                }
            } */

            :host([is-mobile]) #news-container, :host([is-mobile]) #news-container .news-catalog {
                @apply --layout-vertical;
                margin-left: -5px;
            }


                :host([is-mobile]) #news-container,
                :host([is-mobile]) #news-container .news-catalog .small-news-catalog {
                    padding: 0px;
                }


            /* Ipad Pro */
            @media only screen and (min-width: 769px) and (max-width: 1224px) {
                #news-container {
                    @apply --layout-vertical;
                }
                    #news-container news-item[basic] {
                        min-height: 175px;
                    }
            }


            @media only screen and (min-width: 1400px){
                #news-container {
                      min-height: 500px;
                }
            }

        </style>


        <iron-ajax auto id="getpopulercontent" url="/h/main?fm=get-populer-content-default&a=[[datatable]]&b=[[itemsize]]" handle-as="json" on-response="_onResponse" loading="{{loading}}"></iron-ajax>
        <!--<iron-ajax auto="{{go}}" id="getlastcontent" url="/h/main?fm=get-last-content-default&a=[[datatable]]&b=[[lastitemsize]]" handle-as="json" on-response="_responseLast" loading="{{loadinglast}}"></iron-ajax>-->

        <div id="news-container">
            <paper-material elevation="4" class="main-catalog">
                <div class="news-catalog">
                    <div class="big-news-catalog">
                        <animated-content-placeholder class="image-placeholder big-news">
                            <div class="background-masker figure-top"></div>
                            <div class="background-masker figure-left"></div>
                            <div class="background-masker figure-right"></div>
                            <div class="background-masker figure-bottom"></div>
                            <div class="background-masker figcaption-bottom"></div>
                        </animated-content-placeholder>
                        <news-item item="[[news.first]]" basic type="nondeclared" is-mobile=[[isMobile]]></news-item>
                    </div>
                    <div class="small-news-catalog">
                        <animated-content-placeholder class="image-placeholder small-news">
                            <div class="background-masker figure-top"></div>
                            <div class="background-masker figure-left"></div>
                            <div class="background-masker figure-right"></div>
                            <div class="background-masker figure-bottom"></div>
                            <div class="background-masker figcaption-bottom"></div>
                        </animated-content-placeholder>
                        <animated-content-placeholder class="image-placeholder small-news">
                            <div class="background-masker figure-top"></div>
                            <div class="background-masker figure-left"></div>
                            <div class="background-masker figure-right"></div>
                            <div class="background-masker figure-bottom"></div>
                            <div class="background-masker figcaption-bottom"></div>
                        </animated-content-placeholder>
                        <template is="dom-repeat" items={{news.center}} as=item>
                            <news-item item="[[item]]" basic is-mobile=[[isMobile]]></news-item>
                        </template>
                    </div>
                </div>
                <div class="advert-catalog"></div>
            </paper-material>
            <paper-material elevation="1" class="side-catalog">
                <animated-content-placeholder class="image-placeholder small-news">
                    <div class="background-masker figure-top"></div>
                    <div class="background-masker figure-left"></div>
                    <div class="background-masker figure-right"></div>
                    <div class="background-masker figure-bottom"></div>
                    <div class="background-masker figcaption-bottom"></div>
                </animated-content-placeholder>
                <animated-content-placeholder class="image-placeholder small-news">
                    <div class="background-masker figure-top"></div>
                    <div class="background-masker figure-left"></div>
                    <div class="background-masker figure-right"></div>
                    <div class="background-masker figure-bottom"></div>
                    <div class="background-masker figcaption-bottom"></div>
                </animated-content-placeholder>
                <animated-content-placeholder class="image-placeholder extended-news">
                    <div class="background-masker figure-top"></div>
                    <div class="background-masker figure-left"></div>
                    <div class="background-masker figure-right"></div>
                    <div class="background-masker figure-bottom"></div>
                    <div class="background-masker figcaption-bottom"></div>
                </animated-content-placeholder>

                <div id="items">
                    <template is="dom-repeat" items={{news.right}} as=item>
                        <news-item item="[[item]]" extended is-mobile=[[isMobile]]></news-item>
                    </template>
                </div>
                <a class="continue-item" href="/news">
                    <paper-button raised>Daha FazlasÄ±</paper-button>
                </a>
            </paper-material>
        </div>
    </template>
    <script>
        class HomeNews extends Polymer.Element {
            static get is() {
                return 'home-news'
            }

            static get properties() {
                return {
                    isMobile: {
                        type: Boolean,
                        notify: true,
                        reflectToAttribute: true
                    },
                    cdn: {
                        type: String,
                        value: 'https://cdn.kaldirirmi.com/images/news/',
                    },
                    content: {
                        type: Array,
                        value: [],
                        notify: true
                    },
                    datatable: {
                        type: String,
                        value: 'kalnews',
                        notify: true
                    },
                    loading: {
                        type: Boolean,
                        value: false,
                        notify: true
                    },
                    go: {
                        type: Boolean,
                        value: false,
                        notify: true
                    },
                    itemsize: {
                        type: Number,
                        value: 8
                    },
                    news: {
                        type: Object,
                        value: function () {
                            return {
                                first: null,
                                second: null,
                                third: null,
                                center: [],
                                right: []
                            }
                        }
                    },
                };
            }
            /**
              * Called every time the element is inserted into the DOM. Useful for
              * running setup code, such as fetching resources or rendering.
              * Generally, you should try to delay work until this time.
              */
            connectedCallback() {
                super.connectedCallback();

                //test data
               

            }


            /**
              * Use for one-time configuration of your component after local DOM is
              * initialized.
              */
            ready() {
                super.ready();

                // When possible, use afterNextRender to defer non-critical
                // work until after first paint.
                Polymer.RenderStatus.afterNextRender(this, function () {
                    //setTimeout(() => {
                    //    this.set('go', true);
                    //}, 2222);
                });

            }

            _onResponse(a) {
                let index = 0;
                this.shadowRoot.querySelectorAll('.image-placeholder').forEach(function(placeholder){
                    placeholder.remove();
                });

                //console.log(a.detail.response);

                if (a.detail.response === null) {
                    this.demoInit();
                }
                else {
                    //console.log(a.detail.response);

                    if (a.detail.response.length > 0) {
                        a.detail.response.forEach(function (element) {
                            //console.log(element);
                            if (index == 0) {
                                this.set('news.first', element);
                            }
                                //else if (index == 1) {
                                //    this.set('news.second', element);
                                //}
                                //else if (index == 2) {
                                //    this.set('news.third', element);
                                //}
                            else if (index >= 1 && index <= 2) {
                                this.push('news.center', element);
                            }
                            else {
                                this.push('news.right', element);
                            }
                            index++;
                        }, this);
                    }
                }


             
            }

            demoInit() {
                const news = [
                   {
                       "id": 1000094,
                       "title": "YÃ¼kselme Ligi 2017 Yaz Mevsimi MaÃ§larÄ± Sona Erdi",
                       "url": "yukselme-ligi-2017-yaz-mevsimi-maclari-sona-erdi",
                       "picture": "yukselme-ligi-final.jpg",
                       "details": "",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 126,
                       "subtitle": "SÃ¼rpriz sonuÃ§lar geldi, Galatasaray elindeki fÄ±rsatÄ± deÄerlendiremedi.",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000093,
                       "title": "Playerunknownâs Battlegroundsâun HaftalÄ±k GÃ¼ncellemesi YayÄ±nlanacak",
                       "url": "playerunknownâs-battlegroundsâun-haftalik-guncellemesi-yayinlanacak",
                       "picture": "pubg-16-hafta-update.jpg",
                       "details": "",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 148,
                       "subtitle": "16.hafta gÃ¼ncellemesinde birÃ§ok sorun dÃ¼zeltiliyor",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000092,
                       "title": "Steamâde KÃ¶klÃ¼ DeÄiÅiklikler Bizi Bekliyor",
                       "url": "steamâde-koklu-degisiklikler-bizi-bekliyor",
                       "picture": "steam-logo.jpg",
                       "details": "",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 114,
                       "subtitle": "Ä°Åte deÄiÅikliklerâ¦",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000091,
                       "title": "Playerunknownâs Battlegroundsâun Tam SÃ¼rÃ¼mÃ¼ Ertelendi",
                       "url": "playerunknownâs-battlegroundsâun-tam-surumu-ertelendi",
                       "picture": "pubg-haber.jpg",
                       "details": "",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 132,
                       "subtitle": "Tam sÃ¼rÃ¼me 2017 yÄ±lÄ±nÄ±n sonunda geÃ§ilmesi planlanÄ±yor!",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000090,
                       "title": "Assassinâs Creed Origins ne kadar bÃ¼yÃ¼k olacak?",
                       "url": "assassinâs-creed-origins-ne-kadar-buyuk-olacak-",
                       "picture": "assassisns-creed-origins-haber.jpg",
                       "details": "",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 117,
                       "subtitle": "YÃ¶netmeni Ashraf Ismail rÃ¶portajÄ±nda aÃ§Ä±kladÄ±",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000089,
                       "title": "LOL Evinde",
                       "url": "lol-evinde",
                       "picture": "server-relocation-final-merged-fullsize.jpg",
                       "details": "",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 136,
                       "subtitle": "Åimdi Faker DÃ¼ÅÃ¼nsÃ¼n !",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000042,
                       "title": "Mass Effect Andromeda Korsana Yenik DÃ¼ÅtÃ¼",
                       "url": "mass-effect-andromeda-korsana-yenik-dustu",
                       "picture": "masseffectandromeda.jpg",
                       "details": "\u003cp style=\"background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;\"\u003eElectronic\r\nArts\u0026nbsp;ve\u0026nbsp;Bioware\u0026nbsp;iÅbirliÄi ile geliÅtirilen\u0026nbsp;Mass Effect\r\nAndromeda\u0026nbsp;yaklaÅÄ±k 2 hafta Ã¶nce, PC, Playstation 4 ve Xbox Oneâda eÅ\r\nzamanlÄ± olarak satÄ±Åa sunuldu. Hikaye tabanlÄ± bir oyun olan Mass Efffect\r\nAndromeda, maalesef PC platformunda pek de parlak bir grafik Ã§izemedi. PC\r\noyuncularÄ±nÄ±n genel itibariyle, hikaye tabanlÄ± oyunlarÄ± korsan olarak oynamayÄ±\r\ntercih etmesi, en bÃ¼yÃ¼k neden olarak gÃ¶sterilebilir.Bioware,\u0026nbsp;Mass Effect\r\nAndromedaâda\u0026nbsp;Denuvo\u0026nbsp;isimli DRM koruma sistemini kullanÄ±yordu. Bu\r\nsistem Resident Evil 7âde de kullanÄ±lmÄ±Å ve onda da oyuncular 1 haftadan kÄ±sa\r\nbir sÃ¼rede kÄ±rmayÄ± becermiÅlerdi. Kendilerinin baÅÄ±na da aynÄ± Åeyin gelmesinden\r\nkorkan geliÅtiriciler pek de haksÄ±z Ã§Ä±kmadÄ±.Mass Effect Andromeda\u0026nbsp;da bu\r\nduruma yalnÄ±zca 13 gÃ¼n dayanabildi. YapÄ±mcÄ±, Denuvo kalkanlarÄ±nÄ±n devre dÄ±ÅÄ±\r\nbÄ±rakÄ±ldÄ±ÄÄ±nÄ± ve Mass Effect AndromedaânÄ±n âcrackâ dosyasÄ±nÄ±n bÃ¼yÃ¼k bir\r\nbÃ¶lÃ¼mÃ¼nÃ¼n tamamlandÄ±ÄÄ±nÄ± aÃ§Ä±kladÄ±.Ä°Åin aslÄ±na bakarsak, korsanlarÄ± etkisiz\r\nbÄ±rakmanÄ±n yolu, oyunu kÄ±ran topluluklara bir nevi rÃ¼Åvet vermekten geÃ§iyor. Bu\r\nyolun yadsÄ±namaz bir gerÃ§ek olduÄunu kabul eden EA daha Ã¶nceleri FIFA serisinde\r\nkorsanlarla anlaÅmÄ±Å ve oyunun kÄ±rÄ±lmasÄ±nÄ± uzun zaman boyunca engellemiÅti.\r\nBunu sÃ¶ylemek her ne kadar Ã¼zÃ¼cÃ¼ olsa da, maalesef bu tip korsan gruplara\r\nharaÃ§larÄ±nÄ± vermeden, oyunlarÄ± koruma altÄ±na almak mÃ¼mkÃ¼n deÄil.\u003cfont face=\"Arial, sans-serif\"\u003e\u003cspan style=\"background-color: rgb(34, 34, 34);\"\u003e\u003co:p\u003e\u003c/o:p\u003e\u003c/span\u003e\u003c/font\u003e\u003c/p\u003e",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 116,
                       "subtitle": "Korsanlar karÅÄ±sÄ±nda yapÄ±mcÄ±larÄ±n eli kolu baÄlÄ±!",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   },
                   {
                       "id": 1000040,
                       "title": "Saran Medya ve Riot Games TÃ¼rkiye\u0027den Dev Ä°ÅbirliÄi",
                       "url": "saran-medya-ve-riot-games-turkiye-den-dev-isbirligi",
                       "picture": "league-of-legends.jpg",
                       "details": "\u003cp\u003eRiot Games TÃ¼rkiye ile spor yayÄ±ncÄ±lÄ±ÄÄ± pazarlamasÄ±nda dÃ¼nya Åirketleri sÄ±ralamasÄ±nda 5. olan ve yeni spor kanalÄ± \"S Sport\" ile yayÄ±n hayatÄ±na da merhaba diyen \u0026nbsp;Saran Medya, League of Legends TÃ¼rkiye Åampiyonluk Ligiânin televizyon yayÄ±nlarÄ± ile ilgili bir anlaÅma imzaladÄ±lar.YapÄ±lan anlaÅmayla, TÃ¼rkiye\u0027nin Premier spor kanalÄ± S Sport, TÃ¼rkiyeânin ilk profesyonel Espor Ligi League of Legends TÃ¼rkiye Åampiyonluk Ligiânin yayÄ±n haklarÄ±nÄ± satÄ±n aldÄ±. S Sport\u0027un ayrÄ±ca 2017 yÄ±lÄ± iÃ§inde Ãin\u0027de dÃ¼zenlenecek League of Legends DÃ¼nya ÅampiyonasÄ±\u0027nÄ±n da \u0026nbsp;Espor tutkunlarÄ±yla buluÅturulacaÄÄ± bildirildi.Saran Medya ve Riot Games TÃ¼rkiye arasÄ±nda yapÄ±lan iÅ birliÄi \u0026nbsp;sadece maÃ§larÄ±n yayÄ±nlanmasÄ±yla sÄ±nÄ±rlÄ± kalmayacak, ayrÄ±ca \u0026nbsp;haftalÄ±k karÅÄ±laÅmalarda yaÅanan en Ã¶nemli anlar ve Ã¶zetler de S Sport ekranlarÄ±nda hayranlarÄ±yla buluÅacak. BunlarÄ±n yanÄ±nda League of Legends tÃ¼m lig karÅÄ±laÅmalarÄ±yla ilgili yorumlarÄ±n yapÄ±lacaÄÄ±, izleyicilerin en gÃ¼ncel geliÅmeleri takip edilebileceÄi Ã¶zel stÃ¼dyo programlarÄ± da yayÄ±nlanacak.\u003c/p\u003e\u003cp\u003e",
                       "category": null,
                       "publisher": null,
                       "releasedate": null,
                       "viewcount": 109,
                       "subtitle": "League of Legends artÄ±k Televizyonda",
                       "searchkeywords": null,
                       "publisheravatar": null,
                       "relatedgames": null
                   }

                ];

                let index = 0;
                news.forEach(element => {
                    element.picture = 'https://cdn.kaldirirmi.com/images/news/' + element.picture;
                    //console.log(element);
                    if (index == 0) {
                        this.set('news.first', element);
                    }
                    else if (index >= 1 && index <= 2) {
                        this.push('news.center', element);
                    }
                    else {
                        this.push('news.right', element);
                    }
                    index++;
                });
            }
        }

        window.customElements.define(HomeNews.is, HomeNews);
    </script>
</dom-module>